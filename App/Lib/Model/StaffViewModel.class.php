<?phpclass StaffViewModel extends ViewModel {    protected $viewFields;    public function _initialize(){        $main_must_field = array(            'staff_id',            'creator_role_id',            'create_time',            'update_time',            'name'=>'staff_name',            'user_id',            'league_id',            'branch_id',            'wxbind'        );        $main_list = array_unique(array_merge(M('Fields')->where(array('model'=>'staff','is_main'=>1))->getField('field', true),$main_must_field));        $main_list['_type'] = 'LEFT';        $this->viewFields = array(            'staff'=>$main_list,            'user'=>array(                'role_id',                '_on'=>'staff.user_id=user.user_id', '_type'=>'LEFT'            ),            'user_category'=>array(                'name'=>'category_name',                'category_id',                '_on'=>'user.category_id=user_category.category_id', '_type'=>'LEFT'            ),            'position'=>array(                'name'=>'role_name',                'parent_id',                'department_id',                'description',                '_on'=>'position.position_id=staff.position_id',                '_type'=>'LEFT'            ),            'branch'=>array(                'name'=>'branch_name',                '_on'=>'staff.branch_id=branch.branch_id',                '_type'=>'LEFT',            ),            'role_department'=>array(                'name'=>'department_name',                '_on'=>'role_department.department_id=position.department_id'            ),        );    }    public function verity_check($staff) {        $new_staff = $this->where('staff.staff_id = %d',$staff['staff_id'])->find();        $field_list = M('Fields')->where('model = "staff"')->order('order_id')->select();        $exclude_fields = array(            "create_time",            "update_time",            "webshow",            "balance"        );        $change_fields = array();        foreach($field_list as $fv) {            if (in_array($fv['field'], $exclude_fields)) {                continue;            }            if ($new_staff[$fv['field']] != $staff[$fv['field']]) {                $change_fields[] = model_field_diff($fv, $new_staff, $staff);            }        }        return $change_fields;    }}