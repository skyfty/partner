<include file="Public:header" />

<div class="container">
    <!-- Docs nav ================================================== -->
    <div class="page-header">
        <h4><a name="tab">员工详情</a></h4>
    </div>

    <div class="row">
        <div class="span12">
            <include file="Public:alert" />
            <div class="tabbable">
                <include file="Staff:navtab" />
            </div>
            <div class="tab-content">
                <table class="table">
                    <thead>
                    <tr>
                        <td colspan="4">
                            <p style="font-size: 14px;">
                            </p>
                        </td>
                    </tr>
                    </thead>
                    <tbody>
                    <tr>
                        <td colspan="6">
                            <include file="Staff:basicinfo" />
                        </td>
                    </tr>
                    </tbody>
                </table>

                <div>
                    <table id="datatables" class="display datatables" cellspacing="0" width="100%">
                        <thead>
                        <tr>
                            <th></th>
                            <th>时间</th>
                            <th>订单编号</th>
                            <th>服务类别</th>
                            <th>责任人</th>
                            <th>销售评分</th>
                        </tr>
                        </thead>
                    </table>
                </div>

            </div>
        </div>
    </div>
</div>


<script id="staff-evaluate-tmpl" type="text/x-jquery-tmpl">
<table class="table" cellpadding="2" cellspacing="0" border="0">
    <tbody>
        <tr>
            <td class="tdleft" width="15%">时间</td>
            <td>${evaluate_time_show}</td>
            <td class="tdleft" width="15%">订单编号</td>
            <td>{{html market_idcode_show}}</td>
            <td class="tdleft" width="15%">服务类别</td>
            <td>${category_name}
            </td>
        </tr>
        <tr>
            <td class="tdleft" width="15%">责任人</td>
            <td>${market_owner_role_id_show}</td>
            <td class="tdleft" width="15%">销售评分</td>
            <td colspan="3">${sales_evaluate}</td>
        </tr>
        <tr>
            <td class="tdleft" width="15%">销售服务说明</td>
            <td colspan="5">${sales_describe}</td>
        </tr>

    </tbody>
</table>
</script>


<script>

    $(document).ready(function() {
        var table1 = $('#datatables').DataTable( {
            ajax: {
                "data": function(d) {
                },
                "url": "{:U('staff/evaluate_list', 'id='.$staff['staff_id'])}"
            },
            "columns": [
                {
                    "className":      'details-control',
                    "orderable":      false,
                    "data":           null,
                    "defaultContent": ''
                },
                { "data": "evaluate_time_show" },
                { "data": "market_idcode_show" },
                { "data": "category_name" },
                { "data": "market_owner_role_id_show" },
                { "data": "sales_evaluate"}
            ],
            "columnDefs": [
                {
                    "bSortable": false,
                    "targets": 0,

                }
            ],
            "bStateSave":true,
            'searching':false,
            "processing": true,
            "order": [[1, 'asc']],
            'language': def_dataTable_lang_opt,
        } );

        $('#datatables tbody').on('click', 'td.details-control', function () {
            var tr = $(this).closest('tr');
            var row = table1.row( tr );

            if ( row.child.isShown() ) {
                row.child.hide();
                tr.removeClass('shown');
            }
            else {
                row.child($("#staff-evaluate-tmpl").tmpl(row.data())).show();
                tr.addClass('shown');
            }
        } );

    } );

</script>


<include file="Public:footer" />